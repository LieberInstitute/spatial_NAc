* `01-build_spe.*`: construct a (raw, unnormalized) `SpatialExperiment` from the information output from `code/02_image_stitching` and `code/04_VisiumStitcher`. Spatial coordinates are transformed (though the originals are kept) such that each donor represents a single spatially continuous sample; each image also corresponds to a single donor (it turns out not reasonably possible to include both images of individual capture areas and of stitched capture areas).
* `02-filter_normalize_spe.*`: compute log-normalized expression data, compute PCA and an approximation to GLM-PCA, and find highly variable genes (2 different methods)
* `04-plot_multiple_genes.*`: given a list of markers for "subregions" of interest in the NAc (white matter, D1 islands, core, shell), use plotting methods from `spatialNAcUtils` to make single plots that combine expression of all genes in each subregion. One goal was to see if the core and shell exist in the human brain (using markers derived from other species).
* `05-run_nnSVG.*`: run `nnSVG` to find spatially variable genes, using 2 different strategies: running without covariates, and running using `k = 2` PRECAST clusters as covariates. The latter strategy was intended to address the fact that most SVGs from the former strategy simply capture genes that differentiate white and gray matter, rather than more interesting biology specific to the NAc.
* `06-gather_nnSVG.*`: `nnSVG` can only be run for a single sample at a time. This script summarizes the per-sample outputs from `nnSVG` (filtering based on p-value and averaging rank) to form an overall ranking of SVGs for the full dataset. It also visually explores these results.
* `test_plotting.R`: test code to make sure (the code that eventually became) `spatialNAcUtils::spot_plot` functioned as expected
* `update_visium_stitcher.*`: at some point, the `SpatialExperiment` built with the `01` and `02-filter_normalize_spe.*` scripts contained all of the correct information except faulty `VisiumStitcher` outputs. This script manually overwrites the faulty info without going through the lengthy effort of rebuilding the full `SpatialExperiment`
