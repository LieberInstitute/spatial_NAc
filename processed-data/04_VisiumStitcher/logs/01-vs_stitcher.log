/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:69: FutureWarning: Use anndata.concat instead of AnnData.concatenate, AnnData.concatenate is deprecated and will be removed in the future. See the tutorial for concat at: https://anndata.readthedocs.io/en/latest/concatenation.html
  adata = adatas[0].concatenate(adatas[1], adatas[2], adatas[3])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:69: FutureWarning: Use anndata.concat instead of AnnData.concatenate, AnnData.concatenate is deprecated and will be removed in the future. See the tutorial for concat at: https://anndata.readthedocs.io/en/latest/concatenation.html
  adata = adatas[0].concatenate(adatas[1], adatas[2], adatas[3])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:69: FutureWarning: Use anndata.concat instead of AnnData.concatenate, AnnData.concatenate is deprecated and will be removed in the future. See the tutorial for concat at: https://anndata.readthedocs.io/en/latest/concatenation.html
  adata = adatas[0].concatenate(adatas[1], adatas[2], adatas[3])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:67: FutureWarning: Use anndata.concat instead of AnnData.concatenate, AnnData.concatenate is deprecated and will be removed in the future. See the tutorial for concat at: https://anndata.readthedocs.io/en/latest/concatenation.html
  adata = adatas[0].concatenate(adatas[1], adatas[2])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:71: FutureWarning: Use anndata.concat instead of AnnData.concatenate, AnnData.concatenate is deprecated and will be removed in the future. See the tutorial for concat at: https://anndata.readthedocs.io/en/latest/concatenation.html
  adata = adatas[0].concatenate(adatas[1], adatas[2], adatas[3], adatas[4])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:69: FutureWarning: Use anndata.concat instead of AnnData.concatenate, AnnData.concatenate is deprecated and will be removed in the future. See the tutorial for concat at: https://anndata.readthedocs.io/en/latest/concatenation.html
  adata = adatas[0].concatenate(adatas[1], adatas[2], adatas[3])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:69: FutureWarning: Use anndata.concat instead of AnnData.concatenate, AnnData.concatenate is deprecated and will be removed in the future. See the tutorial for concat at: https://anndata.readthedocs.io/en/latest/concatenation.html
  adata = adatas[0].concatenate(adatas[1], adatas[2], adatas[3])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:69: FutureWarning: Use anndata.concat instead of AnnData.concatenate, AnnData.concatenate is deprecated and will be removed in the future. See the tutorial for concat at: https://anndata.readthedocs.io/en/latest/concatenation.html
  adata = adatas[0].concatenate(adatas[1], adatas[2], adatas[3])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:65: FutureWarning: Use anndata.concat instead of AnnData.concatenate, AnnData.concatenate is deprecated and will be removed in the future. See the tutorial for concat at: https://anndata.readthedocs.io/en/latest/concatenation.html
  adata = adatas[0].concatenate(adatas[1])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/users/pravicha/.conda/envs/vs_stitcher/lib/python3.12/site-packages/anndata/_core/anndata.py:1820: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:39: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,2] = transforms_all.x[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:40: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,2] = transforms_all.y[transforms_all.sample_id == sample_key_brain.Slide[i]]
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:41: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,0] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:42: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[0,1] = -np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:43: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,0] = np.sin(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:44: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead
  M[1,1] = np.cos(transforms_all.theta[transforms_all.sample_id == sample_key_brain.Slide[i]])
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:59: FutureWarning: The behavior of DataFrame.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError
  final_overlap = adatas[i].obs.filter(regex='Overlap').astype(int).replace(0, np.nan).idxmax(axis=1).replace(np.nan,'None',regex=True).to_list()
/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/code/04_VisiumStitcher/vs_stitcher.py:69: FutureWarning: Use anndata.concat instead of AnnData.concatenate, AnnData.concatenate is deprecated and will be removed in the future. See the tutorial for concat at: https://anndata.readthedocs.io/en/latest/concatenation.html
  adata = adatas[0].concatenate(adatas[1], adatas[2], adatas[3])
Br2720
Completed reading the annData
Br8492
Completed reading the annData
Br6522
Completed reading the annData
Br6423
Completed reading the annData
Br8325
Completed reading the annData
Br6471
Completed reading the annData
Br2743
Completed reading the annData
Br3942
Completed reading the annData
Br8667
Completed reading the annData
Br6432
Completed reading the annData
