**** Job starts ****
Wed Apr 17 10:46:00 AM EDT 2024
**** JHPCE info ****
User: pravicha
Job id: 4625422
Job name: 01-run_precast_default
Node name: compute-065
Task id: 21
Loading LIBD SLURM module for r_nac/1.0
here() starts at /dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc
Loading required package: parallel
Loading required package: gtools
PRECAST :  An efficient data integration method is provided for multiple spatial transcriptomics data with non-cluster-relevant effects such as the complex batch effects. It unifies spatial factor analysis simultaneously with spatial clustering and embedding alignment, requiring only partially shared cell/domain clusters across datasets. More details can be referred to Wei Liu, et al. (2023) <doi:10.1038/s41467-023-35947-w>.   Check out our Package website (https://feiyoung.github.io/PRECAST/index.html) for a more complete description of the methods and analyses
Loading required package: DelayedArray
Loading required package: stats4
Loading required package: Matrix
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min

Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: S4Vectors

Attaching package: ‘S4Vectors’

The following objects are masked from ‘package:Matrix’:

    expand, unname

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    expand.grid, I, unname

Loading required package: IRanges
Loading required package: S4Arrays
Loading required package: abind

Attaching package: ‘S4Arrays’

The following object is masked from ‘package:abind’:

    abind

The following object is masked from ‘package:base’:

    rowsum

Loading required package: SparseArray

Attaching package: ‘DelayedArray’

The following objects are masked from ‘package:base’:

    apply, scale, sweep

Loading required package: rhdf5

Attaching package: ‘HDF5Array’

The following object is masked from ‘package:rhdf5’:

    h5ls

Loading required package: SeuratObject
Loading required package: sp

Attaching package: ‘sp’

The following object is masked from ‘package:IRanges’:

    %over%


Attaching package: ‘SeuratObject’

The following object is masked from ‘package:IRanges’:

    intersect

The following object is masked from ‘package:S4Vectors’:

    intersect

The following object is masked from ‘package:BiocGenerics’:

    intersect

The following object is masked from ‘package:base’:

    intersect


Attaching package: ‘dplyr’

The following objects are masked from ‘package:IRanges’:

    collapse, desc, intersect, setdiff, slice, union

The following objects are masked from ‘package:S4Vectors’:

    first, intersect, rename, setdiff, setequal, union

The following object is masked from ‘package:matrixStats’:

    count

The following objects are masked from ‘package:BiocGenerics’:

    combine, intersect, setdiff, union

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.0
✔ readr     2.1.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ lubridate::%within%() masks IRanges::%within%()
✖ dplyr::collapse()     masks IRanges::collapse()
✖ dplyr::combine()      masks BiocGenerics::combine()
✖ dplyr::count()        masks matrixStats::count()
✖ dplyr::desc()         masks IRanges::desc()
✖ tidyr::expand()       masks S4Vectors::expand(), Matrix::expand()
✖ dplyr::filter()       masks stats::filter()
✖ dplyr::first()        masks S4Vectors::first()
✖ dplyr::lag()          masks stats::lag()
✖ tidyr::pack()         masks Matrix::pack()
✖ ggplot2::Position()   masks BiocGenerics::Position(), base::Position()
✖ purrr::reduce()       masks IRanges::reduce()
✖ dplyr::rename()       masks S4Vectors::rename()
✖ lubridate::second()   masks S4Vectors::second()
✖ lubridate::second<-() masks S4Vectors::second<-()
✖ purrr::simplify()     masks DelayedArray::simplify()
✖ dplyr::slice()        masks IRanges::slice()
✖ lubridate::stamp()    masks cowplot::stamp()
✖ tidyr::unpack()       masks Matrix::unpack()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
Loading required package: SingleCellExperiment
Loading required package: SummarizedExperiment
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:SparseArray’:

    rowMedians

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians


Attaching package: ‘SummarizedExperiment’

The following object is masked from ‘package:Seurat’:

    Assays

The following object is masked from ‘package:SeuratObject’:

    Assays


Attaching package: ‘ggpubr’

The following object is masked from ‘package:cowplot’:

    get_legend

Loading required package: scuttle
[1] "Output saved at:"
[1] "/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/processed-data/10_precast/nnSVG_default"
[1] "Spatially variable genes obtained from:"
[1] "/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/processed-data/05_harmony_BayesSpace/07-run_nnSVG/nnSVG_out/summary_across_samples.csv"
[1] "Plots saved at:"
[1] "/dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc/plots/10_precast/nnSVG_default/cluster_k_21"
Br2720 
22368 19666 
Br2743 
22368 17571 
Br3942 
22368 18085 
Br6423 
22368 14792 
Br6432 
22368 19211 
Br6471 
22368 18995 
Br6522 
22368 19136 
Br8325 
22368 22221 
Br8492 
22368 16876 
Br8667 
22368 8799 
Filter spots and features from Raw count data...
 
 
2024-04-17 11:07:14.517758 : ***** Filtering step for raw count data finished!, 1.438 mins elapsed.
Select the variable genes for each data batch...
CreatePRECASTObject: remove genes:SLC47A2  C11orf88  IGKC  CFAP73  TTR  SPAG6  CAPSL  MYLK3  CCDC114  FAM92B  IGFBP7-AS1  PCDH11Y  NKX6-2  SOX2-OT  HLA-DPA1  HLA-A  HLA-B  HLA-DRA  XIST  HLA-DRB1  HLA-DPB1  HLA-E  OIP5-AS1  with low count reads in seuList.
2024-04-17 11:07:14.647255 : ***** Gene selection finished!, 0.001 mins elapsed.
Filter spots and features from SVGs(HVGs) count data...
Normalizing layer: counts
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Normalizing layer: counts
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Normalizing layer: counts
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Normalizing layer: counts
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Normalizing layer: counts
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Normalizing layer: counts
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Normalizing layer: counts
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Normalizing layer: counts
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Normalizing layer: counts
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Normalizing layer: counts
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
2024-04-17 11:08:59.744481 : ***** Filtering step for count data with variable genes finished!, 1.322 mins elapsed.
Neighbors were identified for 19663 out of 19665 spots.
Neighbors were identified for 17567 out of 17571 spots.
Neighbors were identified for 18007 out of 18008 spots.
Neighbors were identified for 14790 out of 14791 spots.
Neighbors were identified for 19198 out of 19199 spots.
Neighbors were identified for 18995 out of 18995 spots.
Neighbors were identified for 19114 out of 19116 spots.
Neighbors were identified for 22220 out of 22221 spots.
Neighbors were identified for 16873 out of 16876 spots.
Neighbors were identified for 8784 out of 8787 spots.
-----Intergrative data info.: 10 samples, 1977 genes X 175229 spots------
-----PRECAST model setting: error_heter=TRUE, Sigma_equal=FALSE, Sigma_diag=TRUE, mix_prop_heter=TRUE
Start computing intial values... 

fitting ...
  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
2024-04-17 11:47:52.048917 : ***** Initialization finished!, 33.643 mins elapsed.
----Fitting PRECAST model----------------

variable initialize finish! 
predict Y and V! 
Finish ICM step! 
iter = 2, loglik= -119741184.000000, dloglik=0.944241 
predict Y and V! 
diff Energy = 1.280471 
diff Energy = 10.322165 
diff Energy = 7.607308 
diff Energy = 18.409315 
diff Energy = 34.545765 
diff Energy = 27.007026 
Finish ICM step! 
iter = 3, loglik= -118892240.000000, dloglik=0.007090 
predict Y and V! 
diff Energy = 149.638372 
diff Energy = 71.112478 
diff Energy = 95.615437 
diff Energy = 86.438010 
diff Energy = 144.118375 
diff Energy = 122.644922 
diff Energy = 16.605527 
diff Energy = 126.274222 
diff Energy = 54.728306 
diff Energy = 18.888459 
Finish ICM step! 
iter = 4, loglik= -118582240.000000, dloglik=0.002607 
predict Y and V! 
diff Energy = 48.680656 
diff Energy = 64.428681 
diff Energy = 17.466220 
diff Energy = 100.820044 
diff Energy = 188.206495 
diff Energy = 63.253077 
diff Energy = 29.672775 
diff Energy = 62.118621 
diff Energy = 140.281546 
diff Energy = 0.701052 
Finish ICM step! 
iter = 5, loglik= -118425576.000000, dloglik=0.001321 
predict Y and V! 
diff Energy = 69.508794 
diff Energy = 75.744053 
diff Energy = 30.329958 
diff Energy = 80.724495 
diff Energy = 121.496781 
diff Energy = 62.870411 
diff Energy = 17.670772 
diff Energy = 67.267918 
diff Energy = 84.912123 
diff Energy = 13.859932 
Finish ICM step! 
iter = 6, loglik= -118331024.000000, dloglik=0.000798 
predict Y and V! 
diff Energy = 118.303816 
diff Energy = 14.378550 
diff Energy = 63.227196 
diff Energy = 97.814167 
diff Energy = 124.945379 
diff Energy = 92.574401 
diff Energy = 31.185979 
diff Energy = 69.481051 
diff Energy = 105.067516 
diff Energy = 2.108257 
Finish ICM step! 
iter = 7, loglik= -118268304.000000, dloglik=0.000530 
predict Y and V! 
diff Energy = 29.711332 
diff Energy = 3.498957 
diff Energy = 4.538081 
diff Energy = 75.755141 
diff Energy = 105.936138 
diff Energy = 86.865437 
diff Energy = 11.805839 
diff Energy = 24.159957 
diff Energy = 41.912205 
diff Energy = 14.207605 
Finish ICM step! 
iter = 8, loglik= -118223232.000000, dloglik=0.000381 
predict Y and V! 
diff Energy = 8.278820 
diff Energy = 3.371822 
diff Energy = 17.724560 
diff Energy = 62.448571 
diff Energy = 78.153883 
diff Energy = 49.641576 
diff Energy = 31.235849 
diff Energy = 42.020729 
diff Energy = 13.403176 
Finish ICM step! 
iter = 9, loglik= -118189504.000000, dloglik=0.000285 
predict Y and V! 
diff Energy = 4.565869 
diff Energy = 1.375470 
diff Energy = 57.581454 
diff Energy = 72.545893 
diff Energy = 44.674649 
diff Energy = 10.514985 
diff Energy = 50.012904 
diff Energy = 37.669790 
diff Energy = 33.853183 
Finish ICM step! 
iter = 10, loglik= -118163280.000000, dloglik=0.000222 
predict Y and V! 
diff Energy = 40.724513 
diff Energy = 29.433628 
diff Energy = 46.127399 
diff Energy = 59.030995 
diff Energy = 30.198804 
diff Energy = 19.236793 
diff Energy = 2.757606 
diff Energy = 85.205603 
diff Energy = 13.314222 
Finish ICM step! 
iter = 11, loglik= -118141944.000000, dloglik=0.000181 
predict Y and V! 
diff Energy = 37.357477 
diff Energy = 34.027164 
diff Energy = 22.292860 
diff Energy = 37.898188 
diff Energy = 121.647415 
diff Energy = 40.262947 
diff Energy = 17.308702 
diff Energy = 27.153609 
diff Energy = 28.555554 
diff Energy = 12.072009 
Finish ICM step! 
iter = 12, loglik= -118123768.000000, dloglik=0.000154 
predict Y and V! 
diff Energy = 0.092433 
diff Energy = 11.855151 
diff Energy = 36.397223 
diff Energy = 66.725719 
diff Energy = 47.982234 
diff Energy = 9.960153 
diff Energy = 18.748628 
diff Energy = 36.009166 
diff Energy = 22.969307 
Finish ICM step! 
iter = 13, loglik= -118107864.000000, dloglik=0.000135 
predict Y and V! 
diff Energy = 10.603536 
diff Energy = 27.291704 
diff Energy = 16.410452 
diff Energy = 28.432204 
diff Energy = 63.629412 
diff Energy = 44.960355 
diff Energy = 8.322534 
diff Energy = 22.832543 
diff Energy = 40.595005 
diff Energy = 4.681054 
Finish ICM step! 
iter = 14, loglik= -118093528.000000, dloglik=0.000121 
predict Y and V! 
diff Energy = 10.319279 
diff Energy = 5.905186 
diff Energy = 0.410302 
diff Energy = 45.769283 
diff Energy = 57.424403 
diff Energy = 44.495393 
diff Energy = 33.373362 
diff Energy = 30.025334 
diff Energy = 27.224620 
diff Energy = 25.966792 
Finish ICM step! 
iter = 15, loglik= -118079504.000000, dloglik=0.000119 
predict Y and V! 
diff Energy = 20.766681 
diff Energy = 3.533774 
diff Energy = 52.094631 
diff Energy = 69.760833 
diff Energy = 42.471380 
diff Energy = 24.060777 
diff Energy = 38.113615 
diff Energy = 3.864725 
diff Energy = 11.214101 
Finish ICM step! 
iter = 16, loglik= -118065104.000000, dloglik=0.000122 
predict Y and V! 
diff Energy = 11.797274 
diff Energy = 9.479703 
diff Energy = 31.955299 
diff Energy = 38.091606 
diff Energy = 41.927777 
diff Energy = 15.577410 
diff Energy = 36.647611 
diff Energy = 37.041461 
diff Energy = 22.342045 
diff Energy = 17.136353 
Finish ICM step! 
iter = 17, loglik= -118049840.000000, dloglik=0.000129 
predict Y and V! 
diff Energy = 10.425108 
diff Energy = 21.590008 
diff Energy = 35.822234 
diff Energy = 37.072518 
diff Energy = 25.940416 
diff Energy = 13.264058 
diff Energy = 84.123742 
diff Energy = 0.050961 
diff Energy = 13.326480 
Finish ICM step! 
iter = 18, loglik= -118033264.000000, dloglik=0.000140 
predict Y and V! 
diff Energy = 11.095344 
diff Energy = 6.099487 
diff Energy = 2.055352 
diff Energy = 41.686728 
diff Energy = 39.491918 
diff Energy = 35.256003 
diff Energy = 20.877638 
diff Energy = 49.726335 
diff Energy = 8.140344 
diff Energy = 6.658165 
Finish ICM step! 
iter = 19, loglik= -118015192.000000, dloglik=0.000153 
predict Y and V! 
diff Energy = 31.598420 
diff Energy = 0.214047 
diff Energy = 2.980151 
diff Energy = 109.427354 
diff Energy = 26.494890 
diff Energy = 49.721013 
diff Energy = 28.098647 
diff Energy = 35.865900 
diff Energy = 10.600998 
diff Energy = 2.774628 
Finish ICM step! 
iter = 20, loglik= -117995400.000000, dloglik=0.000168 
predict Y and V! 
diff Energy = 11.076011 
diff Energy = 5.220244 
diff Energy = 14.520693 
diff Energy = 50.338829 
diff Energy = 26.492276 
diff Energy = 13.188477 
diff Energy = 36.067734 
diff Energy = 21.082206 
diff Energy = 7.983862 
Finish ICM step! 
iter = 21, loglik= -117974792.000000, dloglik=0.000175 
predict Y and V! 
diff Energy = 17.916007 
diff Energy = 28.275000 
diff Energy = 18.749449 
diff Energy = 17.670936 
diff Energy = 13.665350 
diff Energy = 37.608567 
diff Energy = 16.077075 
diff Energy = 18.376249 
Finish ICM step! 
iter = 22, loglik= -117954128.000000, dloglik=0.000175 
predict Y and V! 
diff Energy = 2.509006 
diff Energy = 5.332193 
diff Energy = 12.212448 
diff Energy = 51.525316 
diff Energy = 25.324017 
diff Energy = 7.430018 
diff Energy = 22.480444 
diff Energy = 13.734099 
diff Energy = 26.086972 
diff Energy = 2.932202 
Finish ICM step! 
iter = 23, loglik= -117934136.000000, dloglik=0.000169 
predict Y and V! 
diff Energy = 5.195374 
diff Energy = 3.259768 
diff Energy = 3.723748 
diff Energy = 18.748479 
diff Energy = 27.886536 
diff Energy = 19.879898 
diff Energy = 25.493560 
diff Energy = 13.209033 
diff Energy = 30.829498 
diff Energy = 7.225760 
Finish ICM step! 
iter = 24, loglik= -117915576.000000, dloglik=0.000157 
predict Y and V! 
diff Energy = 0.775338 
diff Energy = 27.955917 
diff Energy = 14.138428 
diff Energy = 32.993547 
diff Energy = 15.433159 
diff Energy = 4.591765 
diff Energy = 13.444761 
diff Energy = 13.877771 
diff Energy = 13.974737 
diff Energy = 6.700248 
Finish ICM step! 
iter = 25, loglik= -117898336.000000, dloglik=0.000146 
predict Y and V! 
diff Energy = 3.396845 
diff Energy = 8.801373 
diff Energy = 24.924061 
diff Energy = 19.888947 
diff Energy = 21.117672 
diff Energy = 33.042394 
diff Energy = 14.497275 
diff Energy = 28.684228 
diff Energy = 5.869995 
Finish ICM step! 
iter = 26, loglik= -117882488.000000, dloglik=0.000134 
predict Y and V! 
diff Energy = 8.082158 
diff Energy = 12.013739 
diff Energy = 28.978836 
diff Energy = 13.925515 
diff Energy = 0.807911 
diff Energy = 7.861238 
diff Energy = 11.766465 
diff Energy = 96.066797 
diff Energy = 2.305763 
Finish ICM step! 
iter = 27, loglik= -117867936.000000, dloglik=0.000123 
predict Y and V! 
diff Energy = 10.941299 
diff Energy = 0.198124 
diff Energy = 12.491658 
diff Energy = 21.447963 
diff Energy = 24.109476 
diff Energy = 27.415652 
diff Energy = 12.914684 
diff Energy = 20.156061 
diff Energy = 15.494839 
diff Energy = 10.833265 
Finish ICM step! 
iter = 28, loglik= -117854384.000000, dloglik=0.000115 
predict Y and V! 
diff Energy = 11.397314 
diff Energy = 0.817348 
diff Energy = 3.645768 
diff Energy = 31.226739 
diff Energy = 21.192981 
diff Energy = 1.080717 
diff Energy = 10.049399 
diff Energy = 37.513403 
diff Energy = 0.246770 
diff Energy = 3.995204 
Finish ICM step! 
iter = 29, loglik= -117841664.000000, dloglik=0.000108 
predict Y and V! 
diff Energy = 0.593306 
diff Energy = 2.732993 
diff Energy = 15.766538 
diff Energy = 27.426413 
diff Energy = 24.058637 
diff Energy = 20.228190 
diff Energy = 31.542220 
diff Energy = 20.820175 
diff Energy = 18.801899 
diff Energy = 1.961076 
Finish ICM step! 
iter = 30, loglik= -117829864.000000, dloglik=0.000100 
2024-04-17 18:01:54.286662 : ***** PRECAST model fitting finished!, 374.037 mins elapsed.
The total number of spots exceeds 8e4, thus the subsampling schema will be used to speed up computation.
IntegrateSRTData: the subsampling schema will be used to speed up computation since subsample_rate is smaller than 1.
Using bouth housekeeping gene and PRECAST results to obtain the batch corrected gene expressions.
Start integration...
2024-04-17 18:05:33.890461 : ***** Data integration finished!, 3.511 mins elapsed.
Put the data into a new Seurat object...
2024-04-17 18:06:14.218489 : ***** New Seurat object is generated!, 0.672 mins elapsed.
pdf 
  2 
Calculating cluster 1
Calculating cluster 2
Calculating cluster 3
Calculating cluster 4
Calculating cluster 5
Calculating cluster 6
Calculating cluster 7
Calculating cluster 8
Calculating cluster 9
Calculating cluster 10
Calculating cluster 11
Calculating cluster 12
Calculating cluster 13
Calculating cluster 14
Calculating cluster 15
Calculating cluster 16
Calculating cluster 17
Calculating cluster 18
Calculating cluster 19
Calculating cluster 20
Calculating cluster 21
Warning messages:
1: In mean.fxn(object[features, cells.1, drop = FALSE]) : NaNs produced
2: In mean.fxn(object[features, cells.1, drop = FALSE]) : NaNs produced
3: In mean.fxn(object[features, cells.1, drop = FALSE]) : NaNs produced
pdf 
  2 
pdf 
  2 
Warning message:
Removed 123 rows containing missing values (`geom_point()`). 
pdf 
  2 
Warning message:
Removed 123 rows containing missing values (`geom_point()`). 
pdf 
  2 
─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.3.2 (2023-10-31)
 os       Rocky Linux 9.2 (Blue Onyx)
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       US/Eastern
 date     2024-04-17
 pandoc   3.1.3 @ /jhpce/shared/libd/core/r_nac/1.0/nac_env/bin/pandoc

─ Packages ───────────────────────────────────────────────────────────────────
 package                * version   date (UTC) lib source
 abind                  * 1.4-5     2016-07-21 [1] CRAN (R 4.3.2)
 AnnotationDbi            1.64.1    2023-11-03 [1] Bioconductor
 AnnotationHub            3.10.0    2023-10-24 [1] Bioconductor
 attempt                  0.3.1     2020-05-03 [1] CRAN (R 4.3.2)
 backports                1.4.1     2021-12-13 [1] CRAN (R 4.3.0)
 beachmat                 2.18.0    2023-10-24 [1] Bioconductor
 beeswarm                 0.4.0     2021-06-01 [1] CRAN (R 4.3.2)
 benchmarkme              1.0.8     2022-06-12 [1] CRAN (R 4.3.2)
 benchmarkmeData          1.0.4     2020-04-23 [1] CRAN (R 4.3.2)
 Biobase                * 2.62.0    2023-10-24 [1] Bioconductor
 BiocFileCache            2.10.1    2023-10-26 [1] Bioconductor
 BiocGenerics           * 0.48.1    2023-11-01 [1] Bioconductor
 BiocIO                   1.12.0    2023-10-24 [1] Bioconductor
 BiocManager              1.30.22   2023-08-08 [1] CRAN (R 4.3.2)
 BiocNeighbors            1.20.2    2024-01-07 [1] Bioconductor 3.18 (R 4.3.2)
 BiocParallel             1.36.0    2023-10-24 [1] Bioconductor
 BiocSingular             1.18.0    2023-10-24 [1] Bioconductor
 BiocVersion              3.18.1    2023-11-15 [1] Bioconductor
 Biostrings               2.70.1    2023-10-25 [1] Bioconductor
 bit                      4.0.5     2022-11-15 [1] CRAN (R 4.3.0)
 bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.3.0)
 bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.3.2)
 blob                     1.2.4     2023-03-17 [1] CRAN (R 4.3.0)
 bluster                  1.11.4    2024-02-02 [1] Github (LTLA/bluster@17dd9c8)
 broom                    1.0.5     2023-06-09 [1] CRAN (R 4.3.0)
 bslib                    0.6.1     2023-11-28 [1] CRAN (R 4.3.2)
 cachem                   1.0.8     2023-05-01 [1] CRAN (R 4.3.0)
 car                      3.1-2     2023-03-30 [1] CRAN (R 4.3.2)
 carData                  3.0-5     2022-01-06 [1] CRAN (R 4.3.2)
 cli                      3.6.2     2023-12-11 [1] CRAN (R 4.3.2)
 cluster                  2.1.6     2023-12-01 [1] CRAN (R 4.3.2)
 codetools                0.2-19    2023-02-01 [1] CRAN (R 4.3.0)
 colorspace               2.1-0     2023-01-23 [1] CRAN (R 4.3.0)
 CompQuadForm             1.4.3     2017-04-12 [1] CRAN (R 4.3.2)
 config                   0.3.2     2023-08-30 [1] CRAN (R 4.3.2)
 cowplot                * 1.1.1     2020-12-30 [1] CRAN (R 4.3.2)
 crayon                   1.5.2     2022-09-29 [1] CRAN (R 4.3.0)
 curl                     5.2.0     2023-12-08 [1] CRAN (R 4.3.2)
 data.table               1.14.10   2023-12-08 [1] CRAN (R 4.3.2)
 DBI                      1.1.3     2022-06-18 [1] CRAN (R 4.3.0)
 dbplyr                   2.4.0     2023-10-26 [1] CRAN (R 4.3.1)
 DelayedArray           * 0.28.0    2023-10-24 [1] Bioconductor
 DelayedMatrixStats       1.24.0    2023-10-24 [1] Bioconductor
 deldir                   2.0-2     2023-11-23 [1] CRAN (R 4.3.2)
 digest                   0.6.33    2023-07-07 [1] CRAN (R 4.3.0)
 doParallel               1.0.17    2022-02-07 [1] CRAN (R 4.3.2)
 dotCall64                1.1-1     2023-11-28 [1] CRAN (R 4.3.2)
 dplyr                  * 1.1.4     2023-11-17 [1] CRAN (R 4.3.2)
 dqrng                    0.3.2     2023-11-29 [1] CRAN (R 4.3.2)
 DR.SC                    3.3       2023-08-09 [1] CRAN (R 4.3.2)
 DT                       0.31      2023-12-09 [1] CRAN (R 4.3.2)
 edgeR                    4.0.3     2023-12-10 [1] Bioconductor 3.18 (R 4.3.2)
 ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.3.0)
 ExperimentHub            2.10.0    2023-10-24 [1] Bioconductor
 fansi                    1.0.6     2023-12-08 [1] CRAN (R 4.3.2)
 farver                   2.1.1     2022-07-06 [1] CRAN (R 4.3.0)
 fastDummies              1.7.3     2023-07-06 [1] CRAN (R 4.3.2)
 fastmap                  1.1.1     2023-02-24 [1] CRAN (R 4.3.0)
 fields                   15.2      2023-08-17 [1] CRAN (R 4.3.2)
 filelock                 1.0.3     2023-12-11 [1] CRAN (R 4.3.2)
 fitdistrplus             1.1-11    2023-04-25 [1] CRAN (R 4.3.2)
 forcats                * 1.0.0     2023-01-29 [1] CRAN (R 4.3.0)
 foreach                  1.5.2     2022-02-02 [1] CRAN (R 4.3.0)
 future                   1.33.0    2023-07-01 [1] CRAN (R 4.3.0)
 future.apply             1.11.0    2023-05-21 [1] CRAN (R 4.3.0)
 generics                 0.1.3     2022-07-05 [1] CRAN (R 4.3.0)
 GenomeInfoDb           * 1.38.1    2023-11-08 [1] Bioconductor
 GenomeInfoDbData         1.2.11    2023-12-12 [1] Bioconductor
 GenomicAlignments        1.38.0    2023-10-24 [1] Bioconductor
 GenomicRanges          * 1.54.1    2023-10-29 [1] Bioconductor
 getopt                 * 1.20.4    2023-10-01 [1] CRAN (R 4.3.2)
 ggbeeswarm               0.7.2     2023-04-29 [1] CRAN (R 4.3.2)
 ggplot2                * 3.4.4     2023-10-12 [1] CRAN (R 4.3.2)
 ggpubr                 * 0.6.0     2023-02-10 [1] CRAN (R 4.3.2)
 ggrepel                  0.9.4     2023-10-13 [1] CRAN (R 4.3.2)
 ggridges                 0.5.4     2022-09-26 [1] CRAN (R 4.3.2)
 ggsci                  * 3.0.1     2024-03-02 [1] CRAN (R 4.3.2)
 ggsignif                 0.6.4     2022-10-13 [1] CRAN (R 4.3.2)
 ggthemes                 5.1.0     2024-02-10 [1] CRAN (R 4.3.2)
 GiRaF                    1.0.1     2020-10-14 [1] CRAN (R 4.3.2)
 globals                  0.16.2    2022-11-21 [1] CRAN (R 4.3.0)
 glue                     1.7.0     2024-01-09 [1] CRAN (R 4.3.2)
 goftest                  1.2-3     2021-10-07 [1] CRAN (R 4.3.2)
 golem                    0.4.1     2023-06-05 [1] CRAN (R 4.3.2)
 gridExtra                2.3       2017-09-09 [1] CRAN (R 4.3.2)
 gtable                   0.3.4     2023-08-21 [1] CRAN (R 4.3.1)
 gtools                 * 3.9.5     2023-11-20 [1] CRAN (R 4.3.2)
 HDF5Array              * 1.30.0    2023-10-24 [1] Bioconductor
 here                   * 1.0.1     2020-12-13 [1] CRAN (R 4.3.2)
 hms                      1.1.3     2023-03-21 [1] CRAN (R 4.3.0)
 htmltools                0.5.7     2023-11-03 [1] CRAN (R 4.3.2)
 htmlwidgets              1.6.4     2023-12-06 [1] CRAN (R 4.3.2)
 httpuv                   1.6.13    2023-12-06 [1] CRAN (R 4.3.2)
 httr                     1.4.7     2023-08-15 [1] CRAN (R 4.3.1)
 ica                      1.0-3     2022-07-08 [1] CRAN (R 4.3.2)
 igraph                   1.6.0     2023-12-11 [1] CRAN (R 4.3.2)
 interactiveDisplayBase   1.40.0    2023-10-24 [1] Bioconductor
 IRanges                * 2.36.0    2023-10-24 [1] Bioconductor
 irlba                    2.3.5.1   2022-10-03 [1] CRAN (R 4.3.2)
 iterators                1.0.14    2022-02-05 [1] CRAN (R 4.3.0)
 jquerylib                0.1.4     2021-04-26 [1] CRAN (R 4.3.0)
 jsonlite                 1.8.8     2023-12-04 [1] CRAN (R 4.3.2)
 KEGGREST                 1.42.0    2023-10-24 [1] Bioconductor
 KernSmooth               2.23-22   2023-07-10 [1] CRAN (R 4.3.0)
 labeling                 0.4.3     2023-08-29 [1] CRAN (R 4.3.1)
 later                    1.3.2     2023-12-06 [1] CRAN (R 4.3.2)
 lattice                  0.22-5    2023-10-24 [1] CRAN (R 4.3.1)
 lazyeval                 0.2.2     2019-03-15 [1] CRAN (R 4.3.0)
 leiden                   0.4.3.1   2023-11-17 [1] CRAN (R 4.3.2)
 lifecycle                1.0.4     2023-11-07 [1] CRAN (R 4.3.2)
 limma                    3.58.1    2023-10-31 [1] Bioconductor
 listenv                  0.9.0     2022-12-16 [1] CRAN (R 4.3.0)
 lmtest                   0.9-40    2022-03-21 [1] CRAN (R 4.3.2)
 locfit                   1.5-9.8   2023-06-11 [1] CRAN (R 4.3.2)
 lubridate              * 1.9.3     2023-09-27 [1] CRAN (R 4.3.1)
 magick                   2.8.1     2023-10-22 [1] CRAN (R 4.3.2)
 magrittr                 2.0.3     2022-03-30 [1] CRAN (R 4.3.0)
 maps                     3.4.1.1   2023-11-03 [1] CRAN (R 4.3.2)
 MASS                     7.3-60    2023-05-04 [1] CRAN (R 4.3.0)
 Matrix                 * 1.6-4     2023-11-30 [1] CRAN (R 4.3.2)
 MatrixGenerics         * 1.14.0    2023-10-24 [1] Bioconductor
 matrixStats            * 1.2.0     2023-12-11 [1] CRAN (R 4.3.2)
 mclust                   6.0.1     2023-11-15 [1] CRAN (R 4.3.2)
 memoise                  2.0.1     2021-11-26 [1] CRAN (R 4.3.0)
 metapod                  1.10.0    2023-10-24 [1] Bioconductor
 mime                     0.12      2021-09-28 [1] CRAN (R 4.3.0)
 miniUI                   0.1.1.1   2018-05-18 [1] CRAN (R 4.3.2)
 munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.3.0)
 nlme                     3.1-164   2023-11-27 [1] CRAN (R 4.3.2)
 paletteer                1.6.0     2024-01-21 [1] CRAN (R 4.3.2)
 parallelly               1.36.0    2023-05-26 [1] CRAN (R 4.3.0)
 patchwork                1.1.3     2023-08-14 [1] CRAN (R 4.3.2)
 pbapply                  1.7-2     2023-06-27 [1] CRAN (R 4.3.2)
 pillar                   1.9.0     2023-03-22 [1] CRAN (R 4.3.0)
 pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.3.0)
 plotly                   4.10.3    2023-10-21 [1] CRAN (R 4.3.2)
 plyr                     1.8.9     2023-10-02 [1] CRAN (R 4.3.1)
 png                      0.1-8     2022-11-29 [1] CRAN (R 4.3.2)
 polyclip                 1.10-6    2023-09-27 [1] CRAN (R 4.3.2)
 PRECAST                * 1.6.4     2024-01-25 [1] CRAN (R 4.3.2)
 presto                   1.0.0     2024-03-07 [1] Github (immunogenomics/presto@31dc97f)
 prismatic                1.1.1     2022-08-15 [1] CRAN (R 4.3.2)
 progressr                0.14.0    2023-08-10 [1] CRAN (R 4.3.1)
 promises                 1.2.1     2023-08-10 [1] CRAN (R 4.3.1)
 purrr                  * 1.0.2     2023-08-10 [1] CRAN (R 4.3.1)
 R6                       2.5.1     2021-08-19 [1] CRAN (R 4.3.0)
 RANN                     2.6.1     2019-01-08 [1] CRAN (R 4.3.2)
 rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.3.0)
 RColorBrewer             1.1-3     2022-04-03 [1] CRAN (R 4.3.0)
 Rcpp                     1.0.12    2024-01-09 [1] CRAN (R 4.3.2)
 RcppAnnoy                0.0.21    2023-07-02 [1] CRAN (R 4.3.2)
 RcppHNSW                 0.5.0     2023-09-19 [1] CRAN (R 4.3.2)
 RCurl                    1.98-1.13 2023-11-02 [1] CRAN (R 4.3.2)
 readr                  * 2.1.4     2023-02-10 [1] CRAN (R 4.3.0)
 rematch2                 2.1.2     2020-05-01 [1] CRAN (R 4.3.0)
 reshape2                 1.4.4     2020-04-09 [1] CRAN (R 4.3.0)
 restfulr                 0.0.15    2022-06-16 [1] CRAN (R 4.3.2)
 reticulate               1.34.0    2023-10-12 [1] CRAN (R 4.3.2)
 rhdf5                  * 2.46.1    2023-11-29 [1] Bioconductor 3.18 (R 4.3.2)
 rhdf5filters             1.14.1    2023-11-06 [1] Bioconductor
 Rhdf5lib                 1.24.1    2023-12-11 [1] Bioconductor 3.18 (R 4.3.2)
 rjson                    0.2.21    2022-01-09 [1] CRAN (R 4.3.2)
 rlang                    1.1.3     2024-01-10 [1] CRAN (R 4.3.2)
 ROCR                     1.0-11    2020-05-02 [1] CRAN (R 4.3.2)
 rprojroot                2.0.4     2023-11-05 [1] CRAN (R 4.3.2)
 Rsamtools                2.18.0    2023-10-24 [1] Bioconductor
 RSpectra                 0.16-1    2022-04-24 [1] CRAN (R 4.3.2)
 RSQLite                  2.3.4     2023-12-08 [1] CRAN (R 4.3.2)
 rstatix                  0.7.2     2023-02-01 [1] CRAN (R 4.3.2)
 rsvd                     1.0.5     2021-04-16 [1] CRAN (R 4.3.2)
 rtracklayer              1.62.0    2023-10-24 [1] Bioconductor
 Rtsne                    0.17      2023-12-07 [1] CRAN (R 4.3.2)
 S4Arrays               * 1.2.0     2023-10-24 [1] Bioconductor
 S4Vectors              * 0.40.2    2023-11-23 [1] Bioconductor 3.18 (R 4.3.2)
 sass                     0.4.8     2023-12-06 [1] CRAN (R 4.3.2)
 ScaledMatrix             1.10.0    2023-10-24 [1] Bioconductor
 scales                   1.3.0     2023-11-28 [1] CRAN (R 4.3.2)
 scater                 * 1.30.1    2023-11-16 [1] Bioconductor
 scattermore              1.2       2023-06-12 [1] CRAN (R 4.3.2)
 scran                  * 1.30.0    2023-10-24 [1] Bioconductor
 sctransform              0.4.1     2023-10-19 [1] CRAN (R 4.3.2)
 scuttle                * 1.12.0    2023-10-24 [1] Bioconductor
 sessioninfo            * 1.2.2     2021-12-06 [1] CRAN (R 4.3.2)
 Seurat                 * 5.0.1     2023-11-17 [1] CRAN (R 4.3.2)
 SeuratObject           * 5.0.1     2023-11-17 [1] CRAN (R 4.3.2)
 shiny                    1.8.0     2023-11-17 [1] CRAN (R 4.3.2)
 shinyWidgets             0.8.0     2023-08-30 [1] CRAN (R 4.3.2)
 SingleCellExperiment   * 1.24.0    2023-10-24 [1] Bioconductor
 sp                     * 2.1-2     2023-11-26 [1] CRAN (R 4.3.2)
 spam                     2.10-0    2023-10-23 [1] CRAN (R 4.3.2)
 SparseArray            * 1.2.2     2023-11-07 [1] Bioconductor
 sparseMatrixStats        1.14.0    2023-10-24 [1] Bioconductor
 SpatialExperiment      * 1.12.0    2023-10-24 [1] Bioconductor
 spatialLIBD            * 1.15.1    2023-12-12 [1] Github (LieberInstitute/spatialLIBD@ef76198)
 spatialNAcUtils        * 0.99.0    2023-12-12 [1] Github (LieberInstitute/spatialNAcUtils@24c45ac)
 spatstat.data            3.0-3     2023-10-24 [1] CRAN (R 4.3.2)
 spatstat.explore         3.2-5     2023-10-22 [1] CRAN (R 4.3.2)
 spatstat.geom            3.2-7     2023-10-20 [1] CRAN (R 4.3.2)
 spatstat.random          3.2-2     2023-11-29 [1] CRAN (R 4.3.2)
 spatstat.sparse          3.0-3     2023-10-24 [1] CRAN (R 4.3.2)
 spatstat.utils           3.0-4     2023-10-24 [1] CRAN (R 4.3.2)
 statmod                  1.5.0     2023-01-06 [1] CRAN (R 4.3.2)
 stringi                  1.8.3     2023-12-11 [1] CRAN (R 4.3.2)
 stringr                * 1.5.1     2023-11-14 [1] CRAN (R 4.3.2)
 SummarizedExperiment   * 1.32.0    2023-10-24 [1] Bioconductor
 survival                 3.5-7     2023-08-14 [1] CRAN (R 4.3.1)
 tensor                   1.5       2012-05-05 [1] CRAN (R 4.3.2)
 tibble                 * 3.2.1     2023-03-20 [1] CRAN (R 4.3.0)
 tidyr                  * 1.3.0     2023-01-24 [1] CRAN (R 4.3.0)
 tidyselect               1.2.0     2022-10-10 [1] CRAN (R 4.3.0)
 tidyverse              * 2.0.0     2023-02-22 [1] CRAN (R 4.3.0)
 timechange               0.2.0     2023-01-11 [1] CRAN (R 4.3.0)
 tzdb                     0.4.0     2023-05-12 [1] CRAN (R 4.3.0)
 utf8                     1.2.4     2023-10-22 [1] CRAN (R 4.3.1)
 uwot                     0.1.16    2023-06-29 [1] CRAN (R 4.3.2)
 vctrs                    0.6.5     2023-12-01 [1] CRAN (R 4.3.2)
 vipor                    0.4.5     2017-03-22 [1] CRAN (R 4.3.2)
 viridis                  0.6.4     2023-07-22 [1] CRAN (R 4.3.2)
 viridisLite              0.4.2     2023-05-02 [1] CRAN (R 4.3.0)
 vroom                    1.6.5     2023-12-05 [1] CRAN (R 4.3.2)
 withr                    2.5.2     2023-10-30 [1] CRAN (R 4.3.1)
 XML                      3.99-0.16 2023-11-29 [1] CRAN (R 4.3.2)
 xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.3.0)
 XVector                  0.42.0    2023-10-24 [1] Bioconductor
 yaml                     2.3.8     2023-12-11 [1] CRAN (R 4.3.2)
 zlibbioc                 1.48.0    2023-10-24 [1] Bioconductor
 zoo                      1.8-12    2023-04-13 [1] CRAN (R 4.3.0)

 [1] /jhpce/shared/libd/core/r_nac/1.0/nac_env/lib/R/library

──────────────────────────────────────────────────────────────────────────────
**** Job ends ****
Wed Apr 17 08:27:17 PM EDT 2024
