**** Job starts ****
Wed Nov  8 10:15:46 AM EST 2023
**** JHPCE info ****
User: neagles
Job id: 739179
Job name: filter_normalize_spe
Node name: compute-062
Using 4 cores
Loading conda_R/4.3
Loading required package: SpatialExperiment
Loading required package: SingleCellExperiment
Loading required package: SummarizedExperiment
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: GenomicRanges
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min

Loading required package: S4Vectors

Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    expand.grid, I, unname

Loading required package: IRanges
Loading required package: GenomeInfoDb
Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

here() starts at /dcs04/lieber/marmaypag/spatialNac_LIBD4125/spatial_NAc
── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ lubridate::%within%() masks IRanges::%within%()
✖ dplyr::collapse()     masks IRanges::collapse()
✖ dplyr::combine()      masks Biobase::combine(), BiocGenerics::combine()
✖ dplyr::count()        masks matrixStats::count()
✖ dplyr::desc()         masks IRanges::desc()
✖ tidyr::expand()       masks S4Vectors::expand()
✖ dplyr::filter()       masks stats::filter()
✖ dplyr::first()        masks S4Vectors::first()
✖ dplyr::lag()          masks stats::lag()
✖ ggplot2::Position()   masks BiocGenerics::Position(), base::Position()
✖ purrr::reduce()       masks GenomicRanges::reduce(), IRanges::reduce()
✖ dplyr::rename()       masks S4Vectors::rename()
✖ lubridate::second()   masks S4Vectors::second()
✖ lubridate::second<-() masks S4Vectors::second<-()
✖ dplyr::slice()        masks IRanges::slice()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
Loading required package: rafalib
Loading required package: scuttle
Loading required package: DelayedArray
Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

The following object is masked from ‘package:S4Vectors’:

    expand

Loading required package: S4Arrays
Loading required package: abind

Attaching package: ‘S4Arrays’

The following object is masked from ‘package:abind’:

    abind

The following object is masked from ‘package:base’:

    rowsum


Attaching package: ‘DelayedArray’

The following object is masked from ‘package:purrr’:

    simplify

The following objects are masked from ‘package:base’:

    apply, scale, sweep

Loading required package: rhdf5

Attaching package: ‘HDF5Array’

The following object is masked from ‘package:rhdf5’:

    h5ls

2023-11-08 10:17:22.350921 - Running quickCluster()
[1] "2023-11-08 10:17:22 EST"
Warning messages:
1: In (function (to_check, X, clust_centers, clust_info, dtype, nn,  :
  detected tied distances to neighbors, see ?'BiocNeighbors-ties'
2: In (function (to_check, X, clust_centers, clust_info, dtype, nn,  :
  detected tied distances to neighbors, see ?'BiocNeighbors-ties'
3: In (function (to_check, X, clust_centers, clust_info, dtype, nn,  :
  detected tied distances to neighbors, see ?'BiocNeighbors-ties'
[1] "2023-11-08 10:32:53 EST"
2023-11-08 10:32:53.964912 - Running computeSumFactors()
[1] "2023-11-08 10:32:53 EST"
Warning messages:
1: In (function (x, sizes, min.mean = NULL, positive = FALSE, scaling = NULL)  :
  encountered non-positive size factor estimates
2: In (function (x, sizes, min.mean = NULL, positive = FALSE, scaling = NULL)  :
  encountered non-positive size factor estimates
3: In (function (x, sizes, min.mean = NULL, positive = FALSE, scaling = NULL)  :
  encountered non-positive size factor estimates
4: In (function (x, sizes, min.mean = NULL, positive = FALSE, scaling = NULL)  :
  encountered non-positive size factor estimates
5: In (function (x, sizes, min.mean = NULL, positive = FALSE, scaling = NULL)  :
  encountered non-positive size factor estimates
6: In (function (x, sizes, min.mean = NULL, positive = FALSE, scaling = NULL)  :
  encountered non-positive size factor estimates
[1] "2023-11-08 11:05:55 EST"
[1] "Quick cluster table:"

   1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 
1077 1006  141  219 1034  503  268  210  252  170  111  705  352  303 1360  100 
  17   18   19   20   21   22   23   24   25   26   27   28   29   30   31   32 
1102  842  569  732  481 2877  329  314  415  900  434  467  291  184  544  467 
  33   34   35   36   37   38   39   40   41   42   43   44   45   46   47   48 
 284  280  159  207  985  488  332  557  513  323  172  209  252  280  274  200 
  49   50   51   52   53   54   55   56   57   58   59   60   61   62   63   64 
 145  804  465  133  898  566  865  437  551  142  755  556  153  134 1176  536 
  65   66   67   68   69   70   71   72   73   74   75   76   77   78   79   80 
 361  229  562  378  149  826  643  466  564  247  544  324  198  164  802  214 
  81   82   83   84   85   86   87   88   89   90   91   92   93   94   95   96 
1207  923  359  246  432  795  259  703  434 1107  825  415  132  544  105  174 
  97   98   99  100  101  102  103  104  105  106  107  108  109  110  111  112 
 204  957  431 1037  276  639  306  164  516  568  177  849  642  202  520  225 
 113  114  115  116  117  118  119  120  121  122  123  124  125  126  127  128 
 104  182  219  127  173  541  327  324  571  186  305 1144  434  249  277  138 
 129  130  131  132  133  134  135  136  137  138  139  140  141  142  143  144 
 349  147  618  217  648  695  540  555  183  150  259  102  137  229  111  121 
 145  146  147  148  149  150  151  152  153  154  155  156  157  158  159  160 
 207  474  607  106  676  460  339  436  605  299  245  247  279  529  649  403 
 161  162  163  164  165  166  167  168  169  170  171  172  173  174  175  176 
 355  509  278  326  191  338  188  177  179  317  182  199  508  725  354  919 
 177  178  179  180  181  182  183  184  185  186  187  188  189  190  191  192 
 669  572  620  188  179  123  115  330  548  488  914  481  383  652  444  607 
 193  194  195  196  197  198  199  200  201  202  203  204  205  206  207  208 
 112  663  158  127  438  730  388  258  359  408  217  107  279  169  191  148 
 209  210  211  212  213  214  215  216  217  218  219  220  221  222  223  224 
 465  413  641  464  919  203 1232  108  261  106  180 1173  368 1411  584  194 
 225  226  227  228  229  230  231  232  233  234  235  236  237  238  239  240 
 357  306  230  100  542 1610  466  319  101  306  429  304 1044  390  880 1510 
 241  242  243  244  245  246  247  248  249  250  251  252  253  254  255  256 
 264  199  113  200  399  158  510  543  274  626  318  110  160  349  415  213 
 257  258  259  260  261  262  263  264  265  266  267  268  269  270  271  272 
 197  110  202  576  258  631  503  397  125  184  892  341  475  206  145  515 
 273  274  275  276  277  278  279  280  281  282  283  284  285  286  287  288 
 850  705  272  507  456  365  390  107  327  390  107  716  124  740  787  390 
 289  290  291  292  293  294  295  296  297  298  299  300  301  302  303  304 
 601  292  684  118  791  122  362  323  137  724  552  582  177  371  202  226 
 305  306  307  308  309  310  311  312  313  314  315  316  317  318  319  320 
 174  140  109  150  571  221 1290  909  750  292  219  205  416  543  212  297 
 321  322  323  324  325  326  327  328  329  330  331  332  333  334  335  336 
 977  364  978  234  503 1123  483 1328  751 1595  923 1337 1133  565  389 1089 
 337  338  339  340  341  342  343  344  345  346  347  348  349  350  351  352 
 587  164  216  660  698  238  297  125  166  342  561  488  656  811  465  154 
 353  354  355  356  357  358  359  360  361  362  363  364  365  366  367  368 
 185  277  167  113  744 1132  159  514  582  414  564  100  255  219  445  288 
 369  370  371  372  373  374  375  376  377  378  379  380  381  382  383  384 
 520  809  519  532  306  245  391  210  132  721  454  131  191  461  354  276 
 385  386  387  388  389  390  391  392  393  394  395  396  397  398  399  400 
 202  124  276  218  234  131  200  200  358  484  560  637  980  455  156  543 
 401  402  403 
 327  104  219 
2023-11-08 11:05:55.441203 - Running checking sizeFactors()
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
 0.000001  0.508973  0.844094  1.000000  1.319276 10.410645 
2023-11-08 11:05:57.299334 - Running logNormCounts()
2023-11-08 11:06:30.985875 - Saving HDF5-backed object to control memory later
           used  (Mb) gc trigger    (Mb)   max used    (Mb)
Ncells 11638628 621.6   20665304  1103.7   16209199   865.7
Vcells 41123366 313.8 1585652332 12097.6 1981999931 15121.5
2023-11-08 12:19:30.809682 - Running modelGeneVar()
  V11D01-384_A1 V11D01-384_B1 V11D01-384_C1 V11D01-384_D1 V12D07-074_A1
x numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
y numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
  V12D07-074_B1 V12D07-074_C1 V12D07-074_D1 V12D07-078_A1 V12D07-078_B1
x numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
y numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
  V12D07-078_C1 V12D07-078_D1 V12D07-333_A1 V12D07-333_B1 V12D07-333_C1
x numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
y numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
  V12D07-333_D1 V13F06-313_A1 V13F06-313_B1 V13F06-313_C1 V13F06-313_D1
x numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
y numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
  V13M06-376_A1 V13M06-376_B1 V13M06-376_C1 V13M06-376_D1 V13M06-377_A1
x numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
y numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
  V13M06-377_B1 V13M06-377_C1 V13M06-377_D1 V13M06-378_A1 V13M06-378_B1
x numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
y numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
  V13M06-378_C1 V13M06-378_D1 V13M06-379_A1 V13M06-379_B1 V13M06-379_C1
x numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
y numeric,101   numeric,101   numeric,101   numeric,101   numeric,101  
  V13M06-379_D1 V13M13-362_B1 V13M13-362_C1
x numeric,101   numeric,101   numeric,101  
y numeric,101   numeric,101   numeric,101  
null device 
          1 
2023-11-08 13:02:36.985171 - Running getTopHVGs()
[1] "Num HVGs at FDR = 0.05: 17974"
[1] "Num HVGs at FDR = 0.01: 17257"
2023-11-08 13:02:37.615011 - Running runPCA()
[1] "2023-11-08 13:02:37 EST"
[1] "2023-11-08 13:36:29 EST"
null device 
          1 
2023-11-08 13:36:29.964349 - Running devianceFeatureSelection()
null device 
          1 
2023-11-08 15:39:41.408512 - Running nullResiduals()
2023-11-08 15:45:39.289128 - Running GLM-PCA
There were 50 or more warnings (use warnings() to see the first 50)
2023-11-09 02:04:40.798446 - Saving HDF5-backed filtered spe
There were 50 or more warnings (use warnings() to see the first 50)
2023-11-09 06:18:55.551958 - Saving ordinary filtered spe
/var/spool/slurm/d/job739179/slurm_script: line 22: 2110993 Killed                  Rscript 02-filter_normalize_spe.R
slurmstepd: error: Detected 1 oom-kill event(s) in StepId=739179.batch. Some of your processes may have been killed by the cgroup out-of-memory handler.
